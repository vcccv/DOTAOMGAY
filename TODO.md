
# v2.0

## 环境修改

- [ ] 基于mpqeditor重建mpq重新测试(或仅替换关键文件，例如Units，以实现不重新导入就应用的物编修改)

## 系统

- [ ] UI系统重构
- [x] 玩家模拟发消息
- [x] 通用的GameTimer
- [ ] 新的DamageSystem，应用StackTop
    - [x] 应用StackTop
    - [ ] 减伤流程中判断守卫类单位类型的优化
    - [ ] 灵魂超度受伤流程

## 新增

### 物品

- [ ] **以太之镜**
    - [x] 重做各类震荡波
        - [x] 对于ShockWaveLib的完整实现
        - [x] 食腐蝠群
        - [x] 震荡波
        - [x] 震荡波的神杖升级
        - [x] 龙破斩
        - [x] 超声冲击波
        - [x] 火焰气息
        - [x] 冰火交加
        - [x] 巨浪的神杖升级
        - [x] 超震声波
        - [ ] 吞噬 - 震荡波
        - [ ] 酸液
    - [ ] 各类穿刺实现(不包括毁灭)
    - [x] 兽王斧子
    - [x] 重构沟壑
    - [x] 重构烈火焚身
    - [x] 重构冰封路径
    - [ ] 启明
    - [x] 裂地者
    - [x] 恐怖波动
    - [x] 獠牙冲刺
    - [x] 时间漫游
    - [x] 发射钩爪
    - [x] 波浪形态 实际上根本不需要重做自己就适配了
    - [ ] 肉钩
    - [ ] 2个B和跳刀，似乎要特别适配DataA要+一下

- [ ] 花钱吃A
- [ ] **永恒之盘**

### 技能
- [x] 现在高射火炮拥有神杖升级效果了
- [ ] 绝大部分同类技能不再命令冲突(可以一起选)，包括震荡波类，闪电链、刀阵旋风类
    - [x] 闪电链类 chainlightning 852119
        - [x] 弧形闪电
        - [x] 神灭斩
        - [x] 遥控炸弹
        - [x] 联结
        - [x] 电子涡流
        - [x] 束缚击
        - [x] 追踪导弹
        - [x] 一闪
        - [x] 秘法箭
        - [x] 秘术异蛇
        - [x] 吞噬 - 连环闪电
        - [x] 撕裂伤口
        - [x] 蚀脑
        - [x] 淘汰之刃
        - [x] 无光之盾
        - [x] 麻痹药剂
        - [x] 星体禁锢
        - [x] 燃烧枷锁
        - [x] 灵魂隔断
        - [x] 闪电风暴
        - [x] 崩裂禁锢
        - [x] 死亡一指
        - [x] 命运敕令
    - [x] 刀阵旋风类 fanofknives 852526
        - [x] 战吼
        - [x] 激流
        - [x] 回音击
        - [x] 狂猛
        - [x] 超强力量
        - [x] 热导飞弹
        - [x] 战斗专注
        - [x] 幽魂
        - [x] 奔袭冲撞
        - [x] 不稳定化合物
        - [x] 残影
        - [x] 折光
        - [x] 高射火炮
        - [x] 风行者
        - [x] 海象挥击
        - [x] 刺针扫射
        - [x] 炽热锁链
        - [x] 震荡射击
        - [x] 死亡旋风
        - [x] 焦土
        - [x] 尖刺外壳
        - [x] 痛苦尖叫
        - [x] 等离子场
        - [x] 死亡脉冲
        - [x] 冰晶爆轰 - 激活
        - [x] 黑暗契约
        - [x] 恶魔敕令
        - [x] 召唤佣兽
        - [x] 地狱
    - [x] 蜂群类 carrionswarm 852218
        - [x] 食腐蝠群
        - [x] 震荡波
        - [x] 龙破斩
        - [x] 波浪形态
        - [x] 发芽
        - [x] 时间漫游
        - [x] 冰火交加
    - [x] 酸性炸弹类 acidbomb 852662
        - [x] 巨浪
        - [x] 变体攻击
        - [x] 引燃
        - [x] 液态火
        - [x] 灵魂汲取
        - [x] 火之余烬
    - [x] 震荡波类 shockwave 852125
        - [x] 烈焰焚身
        - [x] 超声冲击波
        - [x] 吞噬 - 震荡波
    - [x] 喷火类 breathoffire 852580
        - [x] 火焰气息
        - [x] 冰封路径
- [x] **刷逼之力**和**召唤巨石**命令冲突修复
- [x] 重写**超震声波**
    - [x] 改变了**超震声波**的作用范围，从始终为200变为初始作用范围175，末端作用范围225。
    - [x] **超震声波**现在在击退结束时不再附带完全控制效果的位移。
    - [x] **超震声波**现在的击中效果为缴械→击退→伤害，而不是击退结束后才施加缴械效果，并且缴械机制更改，避免对于变身单位造成灭顶之灾。
    - [x] **超震声波**给予的缴械不再能被驱散。
    - [x] **超震声波**的神杖升级现在为指向性技能，以适应以太之镜给予额外施法距离。
- [x] **獠牙冲刺**重写，修复了错误选取目标的问题，现在不再拥有悬崖保护，并且不再强制性的打断施法者接下来的施法动作。
- [ ] **无影拳**施法期间不再强制改变施法者的单位类型为灰烬之灵
    - [x] 移除**无影拳**在非RC模式下对于**长大**的限制
- [x] **阿托斯之棍**增加弹道
- [ ] **勋章**降低施法距离 减少持续时间
- [x] 防偷塔
    - [x] 偷塔保护每秒回血90/s > 180/s
    - [x] 基地也防偷塔 基地回血 20/s > 5/s
- [x] **星体禁锢**和**崩裂禁锢**现在不再直接禁用玩家的控制面板，而是可以继续操作
    - [x] 对于HideEx的完整实现，以及无敌计数器
- [x] **冰火交加**的前进距离从500修改至750
- [x] **肉钩**不再有悬崖5秒无碰撞保护，修正了一个代码内的可疑行为
- [x] 重写**竭心光环**
- [x] **魂之挽歌**
    - [x] 现在在灵魂波击中目标后才会施加减速效果，而不是原来的立即对700码范围内所有单位施加减速。
    - [x] 不再对击中的目标施加50%的攻击速度减少。 
    - [x] 修复了在神杖升级后作用效果始终是1级的错误。
    - [x] 现在神杖升级后，灵魂波在回归时如果击中敌方英雄，回归结束时会治疗施法者48/72/96点生命值。
    - [x] 现在神杖升级后，回归的灵魂波以相反的范围选取开始回归，即一开始就应用最大范围，末端为最小范围。
    - [x] 将灵魂波前进距离从900增加至1000。
    - [x] 将每级的灵魂波初始范围75/100/125增加至125。
    - [x] 将每级的灵魂波最大范围从400/425/450调整至425。
- [x] **两级反转**神杖升级的3个波，应用Shockwave
- [ ] 重写所有镜像，现在所有远程镜像的数值降低
    - [x] 镜像的实现
        - [ ] 分身斧
        - [ ] 小娜迦镜像
        - [ ] 混沌之军
        - [ ] 魔法镜像
        - [ ] 复制之墙
        - [ ] 鬼影重重
        - [ ] 灵魂之矛
        - [ ] 神行百变
        - [ ] 并列

## 修复
- [ ] 修正PRD伪随机，使其最小单位为1而不是5(即不再会非5倍数时向下取整)，之前一些技能概率不是5的倍数，其实都向下取整了。
- [x] 重构被动技能系统的实现，修正了变身加重生可能会出现全被动的问题。
    - [x] ,A10U,A11X,A23F,A344,Q003,Q019,Q022,Q035,Q036,Q047,Q067,Q083,Q098,Q099,Q102,Q107,Q119,Q123,Q131,Q133,Q135,Q143,Q147,Q155,Q211,Q231,Q239,Q240,Q250,Q251,Q279,Q283,Q294,Q302,Q303,Q307,Q310,Q319,Q327,Q338,Q347,Q363,Q418,Q431,A3J7
    - [x] 然后还删了个米波的A344,Q003,Q019,Q022,Q035,Q036,Q047,Q067,Q083,Q098,Q099,Q102,Q107,Q119,Q123,Q131,Q133,Q135,Q143,Q147,Q155,Q211,Q231,Q239,Q240,Q250,Q251,Q279,Q283,Q294,Q302,Q303,Q307,Q310,Q319,Q327,Q338,Q347,Q363,Q418,Q431,A3J7
- [x] 修正了**烈火焚身**的神杖升级技能描述错误，应该为1800前进距离而不是900前进距离。
- [x] 修正了**魔龙枪**拆分后，会永久提供射程的bug。
- [x] 修正了在使用分身技能时，携带射程增加的物品时会导致本体射程错误的bug。
- [x] 修正了无法获取幻象单位主属性的bug，连带修正一系列bug。
- [x] 修正***月刃***弹射逻辑错误问题。
- [x] **幽鬼之刃**和**织网**寻路问题修复。
- [x] 修复天灾下路远程兵营被拆后 近卫上路也会刷新高级投刃车的bug
- [ ] **自然之怒**没有树人
- [ ] **熊猫元素**分离 踩地板没效果 火焰醉拳只有暴击没有闪避而且没特效
- [ ] **重生**期间买活进cd
- [ ] 修复**疯狂生长**对于森林之眼判定错误的问题
- [x] 修正了冲击波类的技能对于施法距离和最大距离的混淆。施法距离应该为释放技能时可用的距离，最大距离应该为冲击波最远可以前进的路程。
    - [x] 修复了**食腐蝠群**的前进距离只有700而不810的错误
    - [x] 修复了**龙破斩**的前进距离只有800而不是1075的错误
    - [x] 修复了**超声冲击波**的前进距离只有800而不是900的错误
    - [x] 修复了**火焰气息**的前进距离只有500而不是650的错误
    - [x] 修复了**震荡波**神杖升级后不能点单位施法的错误
    - [x] 修复了**巨浪**的弹道具有碰撞体积和血条的错误
- [x] 现在大多数技能有无敌计数了，在同时起作用的情况下，不再会被前一个所取消效果，并且变身类技能不再取消之前所拥有的无敌效果
    - [x] 无影拳
    - [x] 无敌斩
    - [x] 相位转移
    - [x] 崩裂禁锢
    - [x] 星体禁锢
    - [ ] 噩梦 他这个睡是物编睡不一般 不管
    - [x] 时间漫游
    - [x] 波浪形态
    - [x] 球状闪电
- [ ] 现在大多数无视地形的效果拥有计数了，在同时起作用的情况下，不再会被前一个所取消效果
    - [x] 獠牙冲刺
    - [ ] 幽鬼之刃
    - [ ] 编网
    - [x] 无影拳
    - [x] 无敌斩
    - [x] 时间漫游
    - [x] 波浪形态
    - [x] 球状闪电
- [ ] 重写**嗜血渴望**，现在立即显示隐身单位，而不是在粘滞时间后显示隐身单位
- [x] 重写**暗影之舞**，现在完全的免疫真视效果，而不再是修改目标允许，并且一些技能也可以正常对其生效。
- [ ] 重写**奔袭冲撞**
    - [x] 修正在没有神杖升级且技能等级为2时可以享受神杖升级的减伤效果的错误。
    - [x] 取消**再装填**的内置的45秒内不再重复生效的设置。
    - [x] 现在正确的对玩家所有单位生效，之前仅对主英雄生效，但仍然不对**鬼影重重**生成的幻象以及信使，守卫、建筑生效。
    - [x] 现在践踏正确的应用施法者的主属性，而不是碰撞来源的主属性。
    - [x] 践踏可以作用于肉山

## 不确定可修复的
- [ ] 2个b有时候可能失效 不知道原因
- [ ] 小鱼人大招a凤凰蛋双倍，现在改了目标允许，应该不会

## 优化
- [ ] 修复第一次按命令按钮时调不起来的错误
- [x] 现在默认指令为-sdd3s6fnabborcdusculsp
- [x] 现在错误消息统一使用原生的错误提示
- [x] 现在近战变身为远程，如果目标在射程范围并且处于攻击命令时将会直接攻击。
- [x] 重写了**波浪形态**
- [ ] 优化突破极限移速的回头情况，重写以下技能
    - [ ] **嗜血渴望**
    - [ ] **幻影冲锋**
    - [ ] **变身**
- [ ] 弃用了二进制属性系统，现在例如**决斗**这种技能不再会有增加攻击上限，**编织**不再会有护甲减少/增加上限。
    - [ ] 决斗是自己独立的二进制属性系统，要单独改
- [x] 新的单位行为限制，无敌，沉默，无视地形，相位移动。
- [x] 更准确的判定单位隐身、无敌、沉默相关。
- [ ] 接管变身
- [x] 删除6技能模式马甲
- [x] 暂时取消了神杖特效

## 计划内但不重要的
- [ ] 接管所有变身
- [ ] 优化对己为目标时的多重施法实现
- [ ] 猛犸D重做
- [ ] 海民W重做
- [ ] 魔龙枪和大推推重构
- [ ] 水刀反补
- [ ] 读书偷技能考虑禁用
- [ ] 模型数据调整，建立模型的数据表
- [ ] 检查地精的贪婪bug
- [ ] 可选设置 - 选中其他人时右键地板控制自己的英雄右键地板
- [ ] 重写施法系统 现在的太屎了
